using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data;
using Microsoft.Practices.EnterpriseLibrary.Data;
using System.Data.Common;

namespace DataAccessLayerUtilities
{
    public class DataAccess
    {
        public static int AddBadIPs(string ip, string category, string reason, string source)
        {
            string query = @"Insert Ignore into blocked_ips(ip,Category,reason,source)
                        values(@ip,@Category,@reason,@source)";
            Database db = DatabaseFactory.CreateDatabase();
            DbCommand dbCommand = db.GetSqlStringCommand(query);

            dbCommand.Parameters.Clear();
            db.AddInParameter(dbCommand, "@ip", DbType.String, ip);
            db.AddInParameter(dbCommand, "@Category", DbType.String, category);
            db.AddInParameter(dbCommand, "@reason", DbType.String, reason);
            db.AddInParameter(dbCommand, "@source", DbType.String, source);
            return db.ExecuteNonQuery(dbCommand);
        }
    }
}
