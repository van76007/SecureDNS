namespace Portal.Controllers
{
    using Core.Categories;
    using Models;
    using System.Web.Mvc;


    [Authorize]
    public class MalwareCategoryController : Controller
    {
        public ActionResult Index()
        {
            return RedirectToAction("List");
        }


        public ActionResult New()
        {
            return View();
        }



        [HttpPost]
        public ActionResult Save(MalwareCategoryModel model)
        {
            if(ModelState.IsValid)
            {
                CategoryServices.singleton.Save(model.Name, model.UnifiedResponse, model.Description);
                return RedirectToAction("New");
            }

            return View("New", model);
        }



        [HttpGet]
        public ActionResult Edit(string categoryName)
        {
            Category category = CategoryServices.singleton.GetByName(categoryName);

            MalwareCategoryModel model = null;

            if (category != null)
            {
                model = new MalwareCategoryModel
                            {
                                Name = category.Name,
                                UnifiedResponse = category.UnifiedResponse,
                                Description = category.Description
                            };
            }

            return View("New", model);
        }



        public ActionResult List()
        {
            MalwareCategoriesModel model = new MalwareCategoriesModel
                                               {
                                                   Categories = CategoryServices.singleton.GetAll()
                                               };

            return View(model);
        }



        [HttpGet]
        public ActionResult Delete(string categoryName)
        {
            CategoryServices.singleton.Delete(categoryName);

            return RedirectToAction("List");
        }
    }
}