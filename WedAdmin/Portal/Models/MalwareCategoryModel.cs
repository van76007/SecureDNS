namespace Portal.Models
{
    using System.Collections.Generic;
    using System.ComponentModel.DataAnnotations;
    using System.Text;
    using Core.Categories;



    public class MalwareCategoryModel
    {
        [Required]
        public string Name { get; set; }
        public string Description { get; set; }

        [Required]
        [RegularExpression(@"\b(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b", ErrorMessage = @"Invalid IP")]
        public string UnifiedResponse { get; set; }
    }


    public class MalwareCategoriesModel
    {
        public List<Category> Categories { get; set; }

        public string ParsedHTML
        {
            get
            {
                StringBuilder sb = new StringBuilder();

                foreach (Category c in Categories)
                {
                    sb.AppendFormat("{0} {1} <a href='Edit?categoryName={0}'>edit</a> | <a href='Delete?categoryName={0}' onclick=\"javascript:return confirm('Are you sure?');\">delete</a><br />", c.Name, c.UnifiedResponse);
                }

                return sb.ToString();
            }
        }
    }
}
